exports.importCSV = function(db, csvFile) {
	var csv = require('csv');
	var fs = require('fs');

	var header;
	var docs = [];

	csv()
		.from.stream(fs.createReadStream(csvFile))
		//.to.path(__dirname+'/sample.out')
		.transform( function(row){
  			row.unshift(row.pop());
  			return row;
		})
		.on('record', function(row,index){
			if (index==0) {
				header = row;
			} else {
			var temp = {};
			row.forEach(function(element, index) {
				if (element) {
				temp[header[index]] = element;
				}
			});
			docs.push(temp);
			}
		})
		.on('end', function(count){
  			console.log('Number of lines: '+count);
  			console.log('Number of documents: ' + docs.length);

  			var collection = db.collection('product');
 		 	collection.insert(docs, {w:1}, function(err, result) {
				if (err) {
					console.log("Cannot insert document");
				} else {
					console.log("So far, so good");
				}	
			});
		})
		.on('error', function(error){
  			console.log(error.message);
		});
};
